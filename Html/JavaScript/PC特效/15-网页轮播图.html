<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        img {
            width: 400px;
            height: 300px;
        }

        .lunbotu li {
            list-style: none;
            float: left;
        }

        .lunbotu {
            position: absolute;
            width: 500%;
            height: 100%;
        }

        .box {
            position: relative;
            /* overflow: hidden; */
            width: 400px;
            height: 300px;
            border: 3px solid;
        }

        .btnleft,
        .btnright {
            display: none;
            position: absolute;
            width: 50px;
            height: 50px;
            background-color: rgba(255, 0, 0, 0.4);
        }

        .btnleft {
            top: 50%;
            left: 0;
            transform: translateY(-50%);
        }

        .btnright {
            top: 50%;
            right: 0;
            transform: translateY(-50%);
        }

        .lunbodian {
            position: absolute;
            bottom: 15%;
            left: 50%;
            transform: translateX(-50%);
            /* width: 150px; */
            height: 30px;
            background-color: rgb(232, 182, 182);
        }

        .lunbodian li {
            float: left;
            list-style: none;
            width: 20px;
            height: 20px;
            /* background-color: #fff; */
            border: 1px solid;
            border-radius: 20px;
            margin: 5px;
            z-index: 999;
        }

        .current {
            background-color: purple;
        }
    </style>
    <script src="../js/animate.js"></script>
</head>

<body>
    <div class="box">
        <ul class="lunbotu">
            <li><a href="">
                    <img src="../../../Image/Wp-0001.jpg" alt="">
                </a></li>
            <li><a href="">
                    <img src="../../../Image/Wp-0002.jpg" alt="">
                </a></li>
            <li><a href="">
                    <img src="../../../Image/Wp-0003.jpg" alt="">
                </a></li>
            <li><a href="">
                    <img src="../../../Image/Wp-0004.jpg" alt="">
                </a></li>
        </ul>
        <ul class="lunbodian">
        </ul>
        <div class="btnleft">å·¦</div>
        <div class="btnright">å³</div>
    </div>
    <script>
        var btnleft = document.querySelector('.btnleft');
        var btnright = document.querySelector('.btnright');
        var box = document.querySelector('.box');
        var lunbodian = document.querySelector('.lunbodian');
        var lunbotu = document.querySelector('.lunbotu');
        var imgLis = document.querySelector('.lunbotu').querySelectorAll('li');
        console.log(imgLis);
        box.addEventListener('mouseenter', function () {
            btnleft.style.display = 'block';
            btnright.style.display = 'block';
            clearInterval(timer);
            timer = null; //æ¸…é™¤å®šæ—¶å™¨å˜é‡
        })
        box.addEventListener('mouseleave', function () {
            btnleft.style.display = 'none';
            btnright.style.display = 'none';
            timer = setInterval(function() { //ä»æ–°å¤åˆ¶è¿‡æ¥ å¼€å¯è®¡æ—¶å™¨
            // æ‰‹åŠ¨è°ƒç”¨ç‚¹å‡»äº‹ä»¶
            btnright.click();
        },2000);
        })
        // â­å°åœ†åœˆä¸ªæ•° æ ¹æ®å›¾ç‰‡ä¸ªæ•°è‡ªåŠ¨åŒ–
        var countImg = document.querySelector('.lunbotu').querySelectorAll('li');
        for (var i = 0; i < countImg.length; i++) {
            var newLi = document.createElement('li'); //createElementå‰éœ€è¦document
            lunbodian.appendChild(newLi);
        }
        // â­æŠŠç¬¬ä¸€ä¸ªå°åœ†åœˆæ·»åŠ ç±»çº¢è‰²current  å½“ä¸èµ·ä½œç”¨çš„åŸå› å¯èƒ½æ˜¯ currentæƒçº§ä½äºå…¶ä»–ç±»
        lunbodian.children[0].className = 'current';  //childrenåæ˜¯ä¸­æ‹¬å·[]
        //â­ ç‚¹å‡»å°åœ†åœˆ è¢«ç‚¹å‡»çš„å˜è‰² 
        var oLis = lunbodian.querySelectorAll('li');
        console.log(oLis);
        for (var i = 0; i < oLis.length; i++) {
            // ğŸç»™è½®æ’­ç‚¹æ·»åŠ è‡ªå®šä¹‰å±æ€§ ç´¢å¼•
            oLis[i].setAttribute('date-index', i);
            oLis[i].addEventListener('click', function () {
                for (var j = 0; j < oLis.length; j++) {
                    oLis[j].className = '';
                }
                // console.log(i);//iä¸€ç›´ä¸º4 debug
                // oLis[i].style.backgroundColor = 'purple';
                this.className = 'current';
                // ğŸç‚¹å‡»å°åœ†åœˆ  è·å¾—ç§»åŠ¨ä½ç§» ä»¥åŠç§»åŠ¨å›¾ç‰‡
                var targetLeft = this.getAttribute('date-index') * 400;
                // ä¿®æ”¹kå°åœ†åœˆkå€¼ è®©ç‚¹å‡»å°åœ†åœˆæ—¶ kå€¼ä¹Ÿå‘ç”Ÿæ”¹å˜
                var index = this.getAttribute('date-index');
                k = index;
                // ä¿®æ”¹kå€¼ ä¹Ÿè¦ä¿®æ”¹circle
                circle = index;
                console.log('k:' + k);
                console.log(targetLeft);
                animate(lunbotu, -targetLeft);
            })
        }
        // â­å…‹éš†å›¾ç¬¬ä¸€ä¸ªå›¾æ”¾æœ€å cloneNode trueä¸ºæ·±å…‹éš†å…‹éš†å…¨éƒ¨ falseåˆ™åªå…‹éš†li
        // å°åœ†åœˆæ²¡å¸¦ä¸Šå…‹éš†çš„åŸå›  å°åœ†åœˆä¸ªæ•°æ˜¯åœ¨æ‰«æå›¾è·å¾—å›¾ä¸ªæ•° å…‹éš†åœ¨æ‰«æå
        var firstClone = lunbotu.children[0].cloneNode(true);
        lunbotu.appendChild(firstClone);
        //  â­åŠ¨ç”»æ•ˆæœ
        var circle = 0; //æ§åˆ¶å°åœ†åœˆçš„æ’­æ”¾
        var k = 0; //æ˜¯ç´¢å¼• ä¹Ÿæ˜¯æ§åˆ¶å›¾ä½ç½®çš„å˜é‡
        // â­èŠ‚æµé˜€
        var flag = true;
        btnright.addEventListener('click', function () {
            if(flag) {
                // èŠ‚æµé˜€false æ‰§è¡Œæ­¤åŠ¨ç”»æ—¶ å…¶ä»–åŠ¨ç”»ä¸ä¼šåˆ¤å®šæˆåŠŸ åŠ¨ç”»æ‰§è¡Œå®Œæ¯•åè®¾ç½®ä¸ºtrue
                flag = false;
                // 400ä¸ºä¸€å¼ å›¾å®½åº¦
                // å¦‚æœæˆ‘ä»¬èµ°åˆ°äº†æœ€åå¤åˆ¶çš„ä¸€å¼ å›¾ç‰‡ æ­¤æ—¶ æˆ‘ä»¬ulå¿«é€Ÿå¤åŸ left=0
                if (k == lunbotu.children.length - 1) { // 5 - 1
                    lunbotu.style.left = 0;
                    k = 0;
                }
                k++;
                animate(lunbotu, - k * 400 ,function() {
                    flag = true;//åŠ¨ç”»æ‰§è¡Œå®Œæ¯• è®¾ç½®ä¸ºtrue;
                });
                // â­ç‚¹å‡»å³ä¾§æŒ‰é’® å°åœ†åœˆè·Ÿç€ä¸€èµ·å˜åŒ–
                circle++;
                // å¦‚æœcircleç­‰äº4 ä¹Ÿå°±æ˜¯åœ¨æŒ‰ä¸‹æœ€åä¸€ä¸ªå›¾ï¼ˆéå…‹éš†çš„ï¼‰circleç´¢å¼•ä¸º4æ—¶ è®©â­•ç´¢å¼•ä¸º0
                // if (circle == lunbodian.children.length) {
                //     circle = 0;
                // }
                circle = circle == lunbodian.children.length ? 0 : circle;//ğŸ‘†ä¸‰å…ƒè¿ç®—ç¬¦ç®€å†™
                circleChange();
            }
        })
        btnleft.addEventListener('click', function () {
            if(flag) {
                flag = false;//ä¸‹ä¸ªåŠ¨ç”»å…³é—­ å†æ‰§è¡Œå®Œæœ¬åŠ¨ç”»åæ‰“å¼€
                // 400ä¸ºä¸€å¼ å›¾å®½åº¦
                // k=0æ—¶æŒ‰ å·¦å›¾æ ‡ æ­¤æ—¶è¿›è¡Œåˆ¤å®š åˆ¤å®šæˆåŠŸåˆ™ç¬é—´è·³è½¬å…‹éš†å›¾ ä¹‹åå†åŠ¨ç”»åˆ¤å®š
                if (k == 0) {
                    k = lunbotu.children.length - 1;
                    lunbotu.style.left = -k * 400 + 'px';
                }
                k--;
                animate(lunbotu, - k * 400,function() {
                    flag = true;//ä¸‹ä¸ªåŠ¨ç”»å¯å¼€å¯
                });
                // â­ç‚¹å‡»å³ä¾§æŒ‰é’® å°åœ†åœˆè·Ÿç€ä¸€èµ·å˜åŒ–
                circle--;
                // å½“åœ†åœˆç´¢å¼•ä¸º-1æ—¶ ä¹Ÿå°±æ˜¯ä»ç¬¬ä¸€å¼ å›¾å‘å·¦ç‚¹åˆ°å…‹éš†å›¾ç¬é—´åˆ°æ— ç¼åˆ°å€’æ•°ç¬¬äºŒå¼ 
                // if (circle == -1) {
                //     circle = lunbodian.children.length - 1;
                // }
                circle = circle == -1 ? lunbodian.children.length - 1 : circle; //ğŸ‘†ä¸‰å…ƒè¿ç®—ç¬¦ç®€å†™
                circleChange();
            }
        })
        function circleChange() {
            // â­å…ˆæ¸…é™¤å…¶ä½™å°åœ†åœˆcurrentç±»å
            for (var i = 0; i < lunbodian.children.length; i++) {
                lunbodian.children[i].className = '';
            }
            // ç•™ä¸‹å½“å‰å°åœ†åœˆçš„currentç±»å
            lunbodian.children[circle].className = 'current';
        }

        // â­â­å®šæ—¶å™¨
        var timer = setInterval(function() {
            // æ‰‹åŠ¨è°ƒç”¨ç‚¹å‡»äº‹ä»¶
            btnright.click();
        },2000);
    </script>
</body>

</html>